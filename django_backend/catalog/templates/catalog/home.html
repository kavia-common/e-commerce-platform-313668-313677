{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
<h1 class="h4 mb-3">Products</h1>

<div class="row g-3">
  {% for p in products %}
    <div class="col-12 col-sm-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <img class="card-img-top" src="{{ p.image.url }}" alt="{{ p.name }}">
        <div class="card-body d-flex flex-column">
          <div class="d-flex justify-content-between align-items-start gap-2">
            <h2 class="h6 mb-1">{{ p.name }}</h2>
            <div class="fw-semibold">${{ p.price }}</div>
          </div>

          <div class="mt-auto pt-3 d-flex gap-2">
            <a class="btn btn-outline-primary w-50" href="{% url 'catalog:product_detail' p.id %}">View</a>

            {% if user.is_authenticated %}
              <form class="w-50" method="post" action="{% url 'cart:add_to_cart' p.id %}">
                {% csrf_token %}
                <button class="btn btn-primary w-100" type="submit">Add to cart</button>
              </form>
            {% else %}
              <button class="btn btn-secondary w-50" type="button" disabled>Login to add</button>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <div class="col-12">
      <div class="alert alert-info">No products available.</div>
    </div>
  {% endfor %}
</div>
{% endblock %}
